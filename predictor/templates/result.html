{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prediction Result</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'style.css' %}">

    <style>
        /* Card animation */
        .result-card {
            animation: slideFade 0.8s ease forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        @keyframes slideFade {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Price animation */
        .price {
            font-size: 3rem;
            font-weight: 800;
        }

        .glow {
            text-shadow: 0 0 12px rgba(34,197,94,0.6);
        }
    </style>
</head>

<body class="light-mode">

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8 col-sm-12">
            <div class="card shadow-lg p-4 text-center result-card">

                <h3 class="mb-3">
                    ğŸ’° Predicted Car Price
                </h3>

                <!-- Count-up target stored in data-value -->
                <h1
                    id="price"
                    class="price text-success glow mb-3"
                    data-value="{{ result }}">
                    â‚¹ 0.00 Lakhs
                </h1>

                <p class="text-muted mb-4">
                    Estimated resale value based on your input.
                </p>

                <!-- ğŸ”µ Prediction History -->
                <h5 class="mt-4 mb-3 text-start">ğŸ•’ Last 5 Predictions</h5>

                <ul class="list-group mb-4 text-start">
                    {% for h in history %}
                        <li class="list-group-item">
                            ğŸ’° â‚¹ {{ h.price }} Lakhs  
                            <br>
                            ğŸ“… Year: {{ h.year }} | ğŸš— KMs: {{ h.kms }}
                        </li>
                    {% empty %}
                        <li class="list-group-item text-muted">
                            No previous predictions found.
                        </li>
                    {% endfor %}
                </ul>

                <a href="/" class="btn btn-primary w-100 py-2 mt-2">
                    ğŸ” Predict Another Car
                </a>

            </div>
        </div>
    </div>
</div>

<!-- Count-up Script -->
<script>
document.addEventListener("DOMContentLoaded", function () {

    const priceEl = document.getElementById("price");
    const target = parseFloat(priceEl.dataset.value);
    let current = 0;
    const duration = 800; // ms
    const steps = 40;
    const increment = target / steps;
    const interval = duration / steps;

    const counter = setInterval(() => {
        current += increment;
        if (current >= target) {
            current = target;
            clearInterval(counter);
        }
        priceEl.innerText = `â‚¹ ${current.toFixed(2)} Lakhs`;
    }, interval);

});
</script>

</body>
</html>
